name: Build and Test Workflow
on: 
  pull_request:
  workflow_dispatch:
    inputs:
      FVT_APIML_ARTIFACT:
        description: 'APIML build for integration test'
        required: true
        default: 'libs-release-local/org/zowe/apiml/sdk/zowe-install/*/zowe-install-*.zip'
      FVT_API_ARTIFACT:
        description: 'Jobs API artifact download pattern'
        required: true
        default: 'libs-snapshot-local/org/zowe/explorer/jobs/*/jobs-api-package-*.zip'
      FVT_ZOSMF_HOST:
        description: 'z/OSMF server for integration test'
        required: true
        default: 'zzow01.zowe.marist.cloud'
      FVT_ZOSMF_PORT:
        description: 'z/OSMF port for integration test'
        required: true
        default: '10443'
      FVT_ZOSMF_CREDENTIAL:
        description: 'The SSH credential used to connect to z/OSMF for integration test'
        required: true
        default: 'ssh-marist-server-zzow01-zowep'    #JACK
      FVT_SERVER_HOSTNAME:
        description: 'Server hostname for integration test'
        required: true
        default: 'fvt-test-server'
      API_ML_DEBUG_PROFILES:
        description: 'Debug profiles for API Gateway'
        required: true
        default: 'default'


jobs:
  build:
    runs-on: macos-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Apply Global Environment Variables
        uses: zowe-actions/global-configurations@main
      
      - name: Setup Node
        uses: actions/setup-node@v2
        with:
          node-version: ${{ env.DEFAULT_NODE_VERSION }}
      
      - name: install and build
        run: npm install && npm run prod


      # to access inputs, call ${{ github.event.inputs.SOMETHING }}